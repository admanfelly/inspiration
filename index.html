<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    <title>Android ↔ JS 交互</title>
    <style>
        *{box-sizing:border-box;margin:0;padding:0}
        body{
            font-family:-apple-system,BlinkMacSystemFont,"Helvetica Neue",Helvetica,"PingFang SC","Hiragino Sans GB",Arial,sans-serif;
            padding:12px;
            background:#f5f5f5;
        }
        h2{
            font-size:18px;
            margin:8px 0 12px;
        }
        .btn-grid{
            display:flex;
            flex-wrap:wrap;
            justify-content:flex-start;
            gap:8px;
        }
        button{
            width:calc((100% - 16px) / 3);
            font-size:15px;
            padding:10px 0;
            border:none;
            border-radius:6px;
            background:#0066ff;
            color:#fff;
        }
        h3{
            margin:16px 0 6px;
            font-size:16px;
        }
        textarea{
            width:100%;
            height:540px;           /* 3 倍高度 */
            font-size:14px;
            border:1px solid #ccc;
            border-radius:4px;
            padding:6px;
            resize:none;
        }
        #clearBtn{
            margin-top:8px;
            width:100%;
            padding:10px 0;
            font-size:15px;
            border:none;
            border-radius:6px;
            background:#ff3b30;
            color:#fff;
        }
    </style>
</head>
<body>

<h2>点击按钮调用 Android 方法</h2>

<!-- 按钮网格：一排 3 个，左对齐 -->
<div class="btn-grid" id="buttons"></div>

<h3>Android 返回结果：</h3>
<textarea id="result" readonly></textarea>

<!-- 清空按钮 -->
<button id="clearBtn">清空</button>

<script>
    /* 需要展示的 key（无 8、9） */
    const showKeys = [1,2,3,4,5,6,7,10,11,12,13];

    /* 生成按钮网格 */
    const container = document.getElementById('buttons');
    showKeys.forEach(k=>{
        const btn = document.createElement('button');
        btn.textContent = `Key ${k}`;
        btn.onclick = ()=>sendToAndroid(k);
        container.appendChild(btn);
    });

    /* 构造并发送数据到 Android */
    function sendToAndroid(key){
        let msg = {key, value:`这是来自 JS 的 Key ${key} 请求`};

        switch(key){
            case 1:
            case 2:
                msg.imgType = 'ocr';
                break;
            case 4:
                msg.link = 'https://www.xiaomiev.com/';
                msg.out = Math.random() < 0.5;
                break;
        }

        const jsonStr = JSON.stringify(msg);
        if(window.Android && window.Android.callAndroid){
            window.Android.callAndroid(jsonStr);
        }else{
            alert('Android 接口未注入');
        }
    }

    /* Android 回调函数 */
    function callJs(jsonStr){
        const box = document.getElementById('result');
        box.value += `${new Date().toLocaleTimeString()} 收到：\n${jsonStr}\n\n`;
        box.scrollTop = box.scrollHeight;
    }

    /* 清空按钮事件 */
    document.getElementById('clearBtn').onclick = () => {
        document.getElementById('result').value = '';
    };
</script>

</body>
</html>
